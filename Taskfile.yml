version: "3"

tasks:
  default:
    sources:
      - "*.go"
    cmds:
      - go build -o bin/sanigate
    silent: false
  run:
    cmds:
      - ./bin/sanigate
  release:
    cmds:
      - go build -ldflags "-s -w -X main.version=`git tag --sort=-version:refname | head -n 1`" -o bin/sanigate
      - go install
  test:
    cmds:
      - go test -v --cover -count=1
  coverage:
    cmds:
      - go test -coverprofile coverage.out && go tool cover -html coverage.out
